{#
  Delete Confirmation Modal Component

  Usage:
    {% include "components/delete_modal.html" with context %}

  Required context:
    - modal_id: str (unique ID for this modal, e.g., "delete-dancer-123")
    - item_name: str (what's being deleted, e.g., "Dancer: John Doe")
    - delete_url: str (POST endpoint for deletion)

  Optional context:
    - warning_message: str (additional warning text)
    - cancel_text: str (default: "Cancel")
    - confirm_text: str (default: "Delete")

  CSS: Uses classes from components/_modals.scss
#}

{% set cancel_text = cancel_text|default("Cancel") %}
{% set confirm_text = confirm_text|default("Delete") %}

<dialog id="{{ modal_id }}" class="modal modal-danger" aria-labelledby="{{ modal_id }}-title" aria-describedby="{{ modal_id }}-desc">
  <div class="modal-content">
    <div class="modal-header">
      <h3 id="{{ modal_id }}-title" class="modal-title">Confirm Deletion</h3>
      <button
        type="button"
        class="modal-close"
        aria-label="Close"
        onclick="document.getElementById('{{ modal_id }}').close()"
      >
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="18" y1="6" x2="6" y2="18"></line>
          <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
      </button>
    </div>

    <div class="modal-body" id="{{ modal_id }}-desc">
      <p>Are you sure you want to delete <strong>{{ item_name }}</strong>?</p>

      {% if warning_message %}
      <div class="modal-warning" role="alert">
        <strong>Warning:</strong> {{ warning_message }}
      </div>
      {% endif %}

      <p class="text-muted text-sm">This action cannot be undone.</p>
    </div>

    <div class="modal-footer">
      <form method="POST" action="{{ delete_url }}" class="flex gap-4">
        <button
          type="button"
          class="btn btn-secondary"
          onclick="document.getElementById('{{ modal_id }}').close()"
        >
          {{ cancel_text }}
        </button>
        <button type="submit" class="btn btn-danger">
          {{ confirm_text }}
        </button>
      </form>
    </div>
  </div>
</dialog>

<script>
  // Function to open delete modal
  function openDeleteModal(modalId) {
    const modal = document.getElementById(modalId);
    if (modal) {
      modal.showModal();
    }
  }

  // ESC key handling
  document.getElementById('{{ modal_id }}').addEventListener('keydown', function(e) {
    if (e.key === 'Escape') {
      this.close();
    }
  });
</script>
