{% extends "base.html" %}

{% block title %}Tournament Management - Battle-D{% endblock %}

{% block content %}
<h2>Tournament Management</h2>

<section>
    <p><a href="/overview">â† Back to Overview</a></p>
</section>

{% if has_integrity_issue and current_user.is_admin %}
<section style="background-color: #fff3cd; border: 2px solid #ffc107; padding: 15px; margin: 20px 0;">
    <h3 style="color: #856404; margin-top: 0;">âš ï¸ Data Integrity Warning</h3>
    <p style="color: #856404; margin-bottom: 0;">
        <strong>Multiple active tournaments detected.</strong>
        Only one tournament should be active at a time.
        <a href="/overview" style="color: #856404; text-decoration: underline; font-weight: bold;">Visit Overview to fix this issue</a>.
    </p>
</section>
{% endif %}

<section>
    <h3>Actions</h3>
    <a href="/tournaments/create" style="padding: 8px 16px; background-color: #28a745; color: white; text-decoration: none; border-radius: 4px;">
        + Create New Tournament
    </a>
</section>

<section style="margin-top: 30px;">
    <h3>All Tournaments</h3>
    {% if tournaments %}
        <table border="1" cellpadding="10" style="width: 100%; border-collapse: collapse;">
            <thead>
                <tr style="background-color: #f4f4f4;">
                    <th>Name</th>
                    <th>Status</th>
                    <th>Phase</th>
                    <th>Created At</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for tournament in tournaments %}
                <tr>
                    <td><strong>{{ tournament.name }}</strong></td>
                    <td>
                        <span style="padding: 4px 8px; background-color: {% if tournament.status.value == 'active' %}#28a745{% else %}#6c757d{% endif %}; color: white; border-radius: 4px; font-size: 12px;">
                            {{ tournament.status.value|upper }}
                        </span>
                    </td>
                    <td>
                        <span style="padding: 4px 8px; background-color: #007bff; color: white; border-radius: 4px; font-size: 12px;">
                            {{ tournament.phase.value|upper }}
                        </span>
                    </td>
                    <td>{{ tournament.created_at.strftime('%Y-%m-%d %H:%M') }}</td>
                    <td>
                        <a href="/tournaments/{{ tournament.id }}">View Details</a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>

        <p style="margin-top: 20px;">
            <strong>Total Tournaments:</strong> {{ tournaments|length }}
        </p>
    {% else %}
        {% set title = "No Tournaments Yet" %}
        {% set message = "Create your first tournament to get started" %}
        {% set action_url = "/tournaments/create" %}
        {% set action_text = "Create Tournament" %}
        {% set icon = "ğŸ†" %}
        {% include "components/empty_state.html" %}
    {% endif %}
</section>
{% endblock %}
