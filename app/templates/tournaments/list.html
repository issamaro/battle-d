{% extends "base.html" %}

{% block title %}Tournament Management - Battle-D{% endblock %}

{% block content %}
<h2>Tournament Management</h2>

<section>
    <p><a href="/overview">&larr; Back to Overview</a></p>
</section>

{% if has_integrity_issue and current_user.is_admin %}
<article aria-label="Data integrity warning">
    <header>
        <h3>Data Integrity Warning</h3>
    </header>
    <p>
        <strong>Multiple active tournaments detected.</strong>
        Only one tournament should be active at a time.
        <a href="/overview">Visit Overview to fix this issue</a>.
    </p>
</article>
{% endif %}

<section>
    <h3>Actions</h3>
    <a href="/tournaments/create" role="button">
        + Create New Tournament
    </a>
</section>

<section>
    <h3>All Tournaments</h3>
    {% if tournaments %}
        <figure>
            <table role="grid">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Status</th>
                        <th>Phase</th>
                        <th>Created At</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for tournament in tournaments %}
                    <tr>
                        <td><strong>{{ tournament.name }}</strong></td>
                        <td>
                            <span class="badge {% if tournament.status.value == 'active' %}badge-active{% elif tournament.status.value == 'cancelled' %}badge-warning{% else %}badge-pending{% endif %}">
                                {{ tournament.status.value|upper }}
                            </span>
                        </td>
                        <td>
                            <span class="badge badge-active">
                                {{ tournament.phase.value|upper }}
                            </span>
                        </td>
                        <td>{{ tournament.created_at.strftime('%Y-%m-%d %H:%M') }}</td>
                        <td>
                            <a href="/tournaments/{{ tournament.id }}">View Details</a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </figure>

        <p>
            <strong>Total Tournaments:</strong> {{ tournaments|length }}
        </p>
    {% else %}
        {% set title = "No Tournaments Yet" %}
        {% set message = "Create your first tournament to get started" %}
        {% set action_url = "/tournaments/create" %}
        {% set action_text = "Create Tournament" %}
        {% set icon = "trophy" %}
        {% include "components/empty_state.html" %}
    {% endif %}
</section>
{% endblock %}
