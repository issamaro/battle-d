{% extends "base.html" %}

{% block title %}Encode Tiebreak Battle - Battle-D{% endblock %}

{% block header_title %}Encode Tiebreak Battle{% endblock %}

{% block content %}
<section>
    <p><a href="/battles/{{ battle.id }}">‚Üê Cancel</a></p>
</section>

<article class="battle-card">
    <header>
        <h2>Encode Tiebreak Result</h2>
        <p>Select the winner of this tiebreak battle.</p>
        {% if battle.outcome and battle.outcome.get('winners_needed') %}
        <p><strong>Note:</strong> {{ battle.outcome.get('winners_needed') }} winner(s) needed from {{ battle.outcome.get('total_performers') }} performers.</p>
        {% endif %}
    </header>

    <form action="/battles/{{ battle.id }}/encode" method="post" class="mt-6">
        <section>
            <h3>Select Winner</h3>
            <div class="performer-grid">
                {% for performer in battle.performers %}
                <label class="performer-option">
                    <input type="radio" name="winner_id" value="{{ performer.id }}" required>
                    <div class="performer-option-content">
                        <strong>üé≠ Performer {{ loop.index }}</strong>
                        {% if performer.preselection_score %}
                        <p class="performer-stats">
                            Preselection Score: {{ performer.preselection_score }}
                        </p>
                        {% elif performer.pool_points is not none %}
                        <p class="performer-stats">
                            Pool Points: {{ performer.pool_points }}<br>
                            W-D-L: {{ performer.pool_wins or 0 }}-{{ performer.pool_draws or 0 }}-{{ performer.pool_losses or 0 }}
                        </p>
                        {% endif %}
                    </div>
                </label>
                {% endfor %}
            </div>
        </section>

        <footer class="encode-footer">
            <button type="submit" class="btn btn-primary">Submit Tiebreak Result</button>
            <a href="/battles/{{ battle.id }}" role="button" class="btn btn-secondary">Cancel</a>
        </footer>
    </form>
</article>
{% endblock %}
